<%= render 'routing/modal' %>

<h1><U>Routing</U></h1>

<div class="col-md-12 routing-information">
  <div class="col-md-6 routing-nodes">
    <h4><U>Routing List</U></h4>
    <ul class="routing-nodes-list">
      <% @active_routing_list.each{|nodes| %>
        <li><%= nodes %></li>
      <% } %>
    <ul>
  </div>
  
  <div class="col-md-6 routing-options">
    <h4><U>Options</U></h4>
    <ul class="routing-options-list">
      <U><li>lost_action</U>: <%= @stats_hash["routing"]["lost_action"] %></li>
      <U><li>digst_bits</U>: <%= @stats_hash["routing"]["dgst_bits"] %></li>
      <U><li>div_bits</U>: <%= @stats_hash["routing"]["div_bits"] %></li>
      <U><li>redundancy</U>: <%= @stats_hash["routing"]["redundant"] %></li>
      <U><li>enabled_repetition_host_in_routing_dump</U>: <%= @enabled_repetition_in_routingdump %></li>
      <U><li>enabled_repetition_host_in_booting_option</U>: <%= @stats_hash["stats"]["enabled_repetition_host_in_routing"] %></li>
      <% if repugnant_repetition_option?(@enabled_repetition_in_routingdump, @stats_hash) %>
        <li class="repetition-error-message"> - repetition_host option is differ between routing and booting option.</li>
      <% end %>
    </ul>
  </div>

  <div class="row">
    <div class="col-md-offset-9 col-md-2 download-button">
      <button class="btn btn-success download-dump" data-toggle="modal" data-target="#downloadModal">
        Download routingdump
      </button>
    </div>
  </div>
</div>


<div class="col-md-12 routing-history">
  <h4><U>routing history</U></h4>
  <div class="routing-history-glaph">
    <% if @routing_event.size == 0 %>
      <table class="table table-bordered table-condensed">
        <tr class="history-glaph-title">
          <th>date</th>
          <th>Event</th>
        </tr>
        <tr class="noevent"><td colspan="3">never happened leave or join yet</td></tr>
      </table>

    <% else %>
      <table class="table table-bordered table-condensed table-striped tablesorter">
        <thead class="history-glaph-title">
          <tr class="history-glaph-title">
            <th>date</th>
            <th>Event</th>
          </tr>
        </thead>
        <tbody>
          <% 
            @routing_event.each{|event|
            event =~ /^([-T:\d]+)\.\d+\s(\w+)(.+)$/ %>

            <tr class=<%= column_color($2) %>>
              <td><%= $1 %></td>
              <td><%= $2+$3 %></td>
            </tr>
          <% } %>
        </tbody>
      </table>
    <% end %>
  </div>
</div>
